(this["webpackJsonpkata-pricing"]=this["webpackJsonpkata-pricing"]||[]).push([[0],{13:function(t,e,c){},15:function(t,e,c){"use strict";c.r(e);c(8);var n=c(1),r=c.n(n),i=c(6),a=c.n(i),s=(c(13),Object(n.createContext)({products:[],basketProducts:[],addBasketProduct:function(){},removeBasketProduct:function(){}})),d=function(){return Object(n.useContext)(s)},u=new Intl.NumberFormat("en-GB",{currency:"GBP",minimumFractionDigits:2}).format,o=c(0),j=function(){var t=d(),e=t.basketProducts,c=t.removeBasketProduct;return Object(o.jsx)(o.Fragment,{children:e.map((function(t,e){return Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{"data-testid":"basket-item-".concat(t.id),children:t.name}),Object(o.jsxs)("td",{"data-testid":"basket-price-".concat(t.id),children:[u(t.unitPrice),Object(o.jsx)("button",{title:"remove from the basket","data-testid":"remove-product-".concat(e),onClick:function(){return c(t.id)},children:"\xd7"})]})]},"".concat(t.id,"-").concat(e))}))})},l=[{id:1,name:"Face Masks",unitPrice:2.5,priceLabel:"each"},{id:2,name:"Toilet Paper",unitPrice:.65,priceLabel:"per roll"},{id:3,name:"Hand Sanitizer",unitPrice:3.5,priceLabel:"175ml @ \xa319.99 per litre"}],b={1:{label:"Two Face Masks for \xa34",units:2,price:4},2:{label:"Six rolls of toilet paper for the price of five",units:6,price:3.25}},O=function(){var t=d().basketProducts,e=t.reduce((function(t,e){return t+=e.unitPrice}),0),c=t.reduce((function(t,e){var c=e.id;return t[c]=(t[c]||0)+1,t}),{}),n=Object.entries(c).reduce((function(t,e){var c=Number(e[0]),n=e[1],r=l.find((function(t){return t.id===c})),i=b[c];if(i&&n>=i.units){var a=n%i.units,s=(n-a)/i.units*i.price,d=a*r.unitPrice+s,u=r.unitPrice*n-d;t.push({label:i.label,price:u})}return t}),[]),r=n.reduce((function(t,e){return t+e.price}),0);return{subTotal:e,productSavings:n,totalSavings:r,totalAfterSavings:e-r}},h=function(){return Object(o.jsx)("tr",{children:Object(o.jsx)("td",{colSpan:2,children:"----------------"})})},x=function(){var t=O(),e=t.subTotal,c=t.productSavings,n=t.totalSavings;return 0===c.length?null:Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{children:"Sub-total"}),Object(o.jsx)("td",{"data-testid":"sub-total",children:u(e)})]}),Object(o.jsx)("tr",{children:Object(o.jsx)("td",{colSpan:2,children:"Savings"})}),c.map((function(t,e){var c=t.label,n=t.price;return Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{"data-testid":"savings-product-".concat(e),children:c}),Object(o.jsxs)("td",{"data-testid":"savings-price-".concat(e),children:["-",u(n)]})]},c)})),Object(o.jsx)(h,{}),Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{children:"Total savings"}),Object(o.jsxs)("td",{"data-testid":"total-savings",children:["-",u(n)]})]}),Object(o.jsx)(h,{})]})},f=function(){var t=O().totalAfterSavings;return Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{children:"Total to pay"}),Object(o.jsx)("td",{"data-testid":"total",children:u(t)})]})},p=function(){return Object(o.jsxs)("table",{children:[Object(o.jsx)("caption",{children:"Basket"}),Object(o.jsxs)("tbody",{children:[Object(o.jsx)(j,{}),Object(o.jsx)(x,{}),Object(o.jsx)(f,{})]})]})},v=function(){var t=d(),e=t.products,c=t.addBasketProduct;return Object(o.jsxs)("table",{"data-testid":"products-list",children:[Object(o.jsx)("caption",{children:"Products"}),Object(o.jsx)("tbody",{children:e.map((function(t){var e=b[t.id];return Object(o.jsxs)("tr",{children:[Object(o.jsxs)("td",{children:[Object(o.jsx)("strong",{children:t.name}),e&&Object(o.jsx)("div",{children:e.label})]}),Object(o.jsxs)("td",{children:[u(t.unitPrice)," (",t.priceLabel,")",Object(o.jsx)("button",{"data-testid":"add-product-".concat(t.id),onClick:function(){c(t.id)},children:"Add item"})]})]},t.id)}))})]})},m=c(5),g=c(7),k=function(t){var e=t.children,c=Object(n.useState)([]),r=Object(g.a)(c,2),i=r[0],a=r[1],d=Object(n.useCallback)((function(t){a((function(e){return[].concat(Object(m.a)(e),[t]).sort()}))}),[]),u=Object(n.useCallback)((function(t){var e=Object(m.a)(i);e.splice(e.findIndex((function(e){return e===t})),1),a(e)}),[i]),j=i.reduce((function(t,e){var c=l.find((function(t){return t.id===e}));return t.push(c),t}),[]);return Object(o.jsx)(s.Provider,{value:{products:l,basketProducts:j,addBasketProduct:d,removeBasketProduct:u},children:e})};var P=function(){return Object(o.jsxs)(k,{children:[Object(o.jsx)(v,{}),Object(o.jsx)(p,{})]})},S=function(t){t&&t instanceof Function&&c.e(3).then(c.bind(null,16)).then((function(e){var c=e.getCLS,n=e.getFID,r=e.getFCP,i=e.getLCP,a=e.getTTFB;c(t),n(t),r(t),i(t),a(t)}))};a.a.render(Object(o.jsx)(r.a.StrictMode,{children:Object(o.jsx)(P,{})}),document.getElementById("root")),S()},8:function(t,e,c){}},[[15,1,2]]]);
//# sourceMappingURL=main.4e9a3d76.chunk.js.map