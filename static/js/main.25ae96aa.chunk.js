(this["webpackJsonpkata-pricing"]=this["webpackJsonpkata-pricing"]||[]).push([[0],{13:function(t,e,c){},15:function(t,e,c){"use strict";c.r(e);c(8);var n=c(1),r=c.n(n),i=c(6),a=c.n(i),s=(c(13),Object(n.createContext)({products:[],basketProducts:[],addBasketProduct:function(){},removeBasketProduct:function(){}})),d=function(){return Object(n.useContext)(s)},o=new Intl.NumberFormat("en-GB",{currency:"GBP",minimumFractionDigits:2}).format,u=c(0),j=function(){var t=d(),e=t.basketProducts,c=t.removeBasketProduct;return Object(u.jsx)(u.Fragment,{children:e.map((function(t,e){return Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{"data-testid":"basket-item-".concat(t.id),children:t.name}),Object(u.jsxs)("td",{"data-testid":"basket-price-".concat(t.id),children:[o(t.unitPrice),Object(u.jsx)("button",{title:"remove from the basket","data-testid":"remove-product-".concat(e),onClick:function(){return c(t.id)},children:"X"})]})]},"".concat(t.id,"-").concat(e))}))})},l=[{id:1,name:"Face Masks",unitPrice:2.5,priceLabel:"each"},{id:2,name:"Toilet Paper",unitPrice:.65,priceLabel:"per roll"},{id:3,name:"Hand Sanitizer",unitPrice:3.5,priceLabel:"175ml @ \xa319.99 per litre"}],b={1:{label:"Two Face Masks for \xa34",units:2,price:4},2:{label:"Six rolls of toilet paper for the price of five",units:6,price:3.25}},O=function(){var t=d().basketProducts,e=t.reduce((function(t,e){return t+=e.unitPrice}),0),c=t.reduce((function(t,e){var c=e.id;return t[c]=(t[c]||0)+1,t}),{}),n=Object.entries(c).reduce((function(t,e){var c=Number(e[0]),n=e[1],r=l.find((function(t){return t.id===c})),i=b[c];if(i){if(n<i.units)return t;var a=n%i.units,s=(n-a)/i.units*i.price,d=a*r.unitPrice+s,o=r.unitPrice*n-d;t.push({label:i.label,price:o})}return t}),[]),r=n.reduce((function(t,e){return t+e.price}),0);return{subTotal:e,productSavings:n,totalSavings:r,totalAfterSavings:e-r}},h=function(){var t=O(),e=t.subTotal,c=t.productSavings,n=t.totalSavings;return 0===c.length?null:Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("tr",{children:Object(u.jsx)("td",{colSpan:2,children:"----------------"})}),Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{children:"Sub-total"}),Object(u.jsx)("td",{"data-testid":"sub-total",children:o(e)})]}),Object(u.jsx)("tr",{children:Object(u.jsx)("td",{colSpan:2,children:"Savings"})}),c.map((function(t,e){var c=t.label,n=t.price;return Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{"data-testid":"savings-product-".concat(e),children:c}),Object(u.jsxs)("td",{"data-testid":"savings-price-".concat(e),children:["-",o(n)]})]},c)})),Object(u.jsx)("tr",{children:Object(u.jsx)("td",{colSpan:2,children:"----------------"})}),Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{children:"Total savings"}),Object(u.jsxs)("td",{"data-testid":"total-savings",children:["-",o(n)]})]})]})},x=function(){var t=O().totalAfterSavings;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("tr",{children:Object(u.jsx)("td",{colSpan:2,children:"----------------"})}),Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{children:"Total to pay"}),Object(u.jsx)("td",{"data-testid":"total",children:o(t)})]})]})},f=function(){return Object(u.jsxs)("table",{children:[Object(u.jsx)("caption",{children:"Basket"}),Object(u.jsxs)("tbody",{children:[Object(u.jsx)(j,{}),Object(u.jsx)(h,{}),Object(u.jsx)(x,{})]})]})},p=function(){var t=d(),e=t.products,c=t.addBasketProduct;return Object(u.jsxs)("table",{"data-testid":"products-list",children:[Object(u.jsx)("caption",{children:"Products"}),Object(u.jsx)("tbody",{children:e.map((function(t){var e=b[t.id];return Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[Object(u.jsx)("strong",{children:t.name}),e&&Object(u.jsx)("div",{children:e.label})]}),Object(u.jsxs)("td",{children:[o(t.unitPrice)," (",t.priceLabel,")",Object(u.jsx)("button",{"data-testid":"add-product-".concat(t.id),onClick:function(){c(t.id)},children:"Add item"})]})]},t.id)}))})]})},v=c(5),m=c(7),g=function(t){var e=t.children,c=Object(n.useState)([]),r=Object(m.a)(c,2),i=r[0],a=r[1],d=Object(n.useCallback)((function(t){a((function(e){return[].concat(Object(v.a)(e),[t]).sort()}))}),[]),o=Object(n.useCallback)((function(t){var e=Object(v.a)(i);e.splice(e.findIndex((function(e){return e===t})),1),a(e)}),[i]),j=i.reduce((function(t,e){var c=l.find((function(t){return t.id===e}));return t.push(c),t}),[]);return Object(u.jsx)(s.Provider,{value:{products:l,basketProducts:j,addBasketProduct:d,removeBasketProduct:o},children:e})};var k=function(){return Object(u.jsxs)(g,{children:[Object(u.jsx)(p,{}),Object(u.jsx)(f,{})]})},P=function(t){t&&t instanceof Function&&c.e(3).then(c.bind(null,16)).then((function(e){var c=e.getCLS,n=e.getFID,r=e.getFCP,i=e.getLCP,a=e.getTTFB;c(t),n(t),r(t),i(t),a(t)}))};a.a.render(Object(u.jsx)(r.a.StrictMode,{children:Object(u.jsx)(k,{})}),document.getElementById("root")),P()},8:function(t,e,c){}},[[15,1,2]]]);
//# sourceMappingURL=main.25ae96aa.chunk.js.map